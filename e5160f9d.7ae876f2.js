(window.webpackJsonp=window.webpackJsonp||[]).push([[233],{335:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return a})),n.d(t,"metadata",(function(){return c})),n.d(t,"rightToc",(function(){return l})),n.d(t,"default",(function(){return p}));var i=n(1),o=n(7),r=(n(0),n(357)),a={id:"go-activity-async-completion",title:"Asynchronous Activity Completion"},c={id:"version-0.23.1/go-activity-async-completion",isDocsHomePage:!1,title:"Asynchronous Activity Completion",description:"There are certain scenarios when completing an activity upon completion of its function is not possible",source:"@site/versioned_docs/version-0.23.1/go-activity-async-completion.md",permalink:"/docs/0.23.1/go-activity-async-completion",editUrl:"https://github.com/temporalio/documentation-legacy/blob/master/versioned_docs/version-0.23.1/go-activity-async-completion.md",version:"0.23.1",sidebar:"version-0.23.1/docs",previous:{title:"Queries",permalink:"/docs/0.23.1/go-queries"},next:{title:"Testing",permalink:"/docs/0.23.1/go-workflow-testing"},latestVersionMainDocPermalink:"/docs/overview"},l=[],s={rightToc:l};function p(e){var t=e.components,n=Object(o.a)(e,["components"]);return Object(r.b)("wrapper",Object(i.a)({},s,n,{components:t,mdxType:"MDXLayout"}),Object(r.b)("p",null,"There are certain scenarios when completing an activity upon completion of its function is not possible\nor desirable. For example, you might have an application that requires user input in order to complete\nthe activity. You could implement the activity with a polling mechanism, but a simpler and less\nresource-intensive implementation is to asynchronously complete a Temporal activity."),Object(r.b)("p",null,"There two parts to implementing an asynchronously completed activity:"),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},"The activity provides the information necessary for completion from an external system and notifies\nthe Temporal service that it is waiting for that outside callback."),Object(r.b)("li",{parentName:"ol"},"The external service calls the Temporal service to complete the activity.")),Object(r.b)("p",null,"The following example demonstrates the first part:"),Object(r.b)("pre",null,Object(r.b)("code",Object(i.a)({parentName:"pre"},{className:"language-go"}),'// Retrieve the activity information needed to asynchronously complete the activity.\nactivityInfo := activity.GetInfo(ctx)\ntaskToken := activityInfo.TaskToken\n\n// Send the taskToken to the external service that will complete the activity.\n...\n\n// Return from the activity a function indicating that Temporal should wait for an async completion\n// message.\nreturn "", activity.ErrResultPending\n')),Object(r.b)("p",null,"The following code demonstrates how to complete the activity successfully:"),Object(r.b)("pre",null,Object(r.b)("code",Object(i.a)({parentName:"pre"},{className:"language-go"}),"// Instantiate a Temporal service client.\n// The same client can be used to complete or fail any number of activities.\n// The client is a heavyweight object that should be created once per process.\nserviceClient, err := client.NewClient(client.Options{})\n\n// Complete the activity.\nclient.CompleteActivity(taskToken, result, nil)\n")),Object(r.b)("p",null,"To fail the activity, you would do the following:"),Object(r.b)("pre",null,Object(r.b)("code",Object(i.a)({parentName:"pre"},{className:"language-go"}),"// Fail the activity.\nclient.CompleteActivity(taskToken, nil, err)\n")),Object(r.b)("p",null,"Following are the parameters of the ",Object(r.b)("inlineCode",{parentName:"p"},"CompleteActivity")," function:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"taskToken"),": The value of the binary ",Object(r.b)("inlineCode",{parentName:"li"},"TaskToken")," field of the ",Object(r.b)("inlineCode",{parentName:"li"},"ActivityInfo")," struct retrieved inside\nthe activity."),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"result"),": The return value to record for the activity. The type of this value must match the type\nof the return value declared by the activity function."),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"err"),": The error code to return if the activity terminates with an error.")),Object(r.b)("p",null,"If ",Object(r.b)("inlineCode",{parentName:"p"},"error")," is not null, the value of the ",Object(r.b)("inlineCode",{parentName:"p"},"result")," field is ignored."))}p.isMDXComponent=!0},357:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return y}));var i=n(0),o=n.n(i);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,i,o=function(e,t){if(null==e)return{};var n,i,o={},r=Object.keys(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=o.a.createContext({}),p=function(e){var t=o.a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):c({},t,{},e)),n},u=function(e){var t=p(e.components);return o.a.createElement(s.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return o.a.createElement(o.a.Fragment,{},t)}},b=Object(i.forwardRef)((function(e,t){var n=e.components,i=e.mdxType,r=e.originalType,a=e.parentName,s=l(e,["components","mdxType","originalType","parentName"]),u=p(n),b=i,y=u["".concat(a,".").concat(b)]||u[b]||m[b]||r;return n?o.a.createElement(y,c({ref:t},s,{components:n})):o.a.createElement(y,c({ref:t},s))}));function y(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=n.length,a=new Array(r);a[0]=b;var c={};for(var l in t)hasOwnProperty.call(t,l)&&(c[l]=t[l]);c.originalType=e,c.mdxType="string"==typeof e?e:i,a[1]=c;for(var s=2;s<r;s++)a[s]=n[s];return o.a.createElement.apply(null,a)}return o.a.createElement.apply(null,n)}b.displayName="MDXCreateElement"}}]);